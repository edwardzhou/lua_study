<script type="text/javascript">
    var bbc = {};
    bbc.getDateList = {
        defauYearStart: 1970,
        defauYearEnd: 2031,
        yearHtml: function (objOption) {
            if ($('#' + objOption.yearOjb.yearId).length == 0) {
                alert('当前文档没有定义年份属性' + objOption.yearOjb.yearId + '值');
                return;
            }

            var newOptions = "";
            //增加默认月份
            if (objOption.yearOjb.yearStart != undefined) {
                var stringYearStart = objOption.yearOjb.yearStart;
            } else {
                var stringYearStart = objOption.operaterDom.defauYearStart;
            }


            if (objOption.yearOjb.yearEnd != undefined) {
                var stringYearEnd = objOption.yearOjb.yearEnd;
            } else {
                var stringYearEnd = objOption.operaterDom.defauYearEnd;
            }

//            for(i=0;i<23;i++){
//                newHour +=  "<option value='"+i+"'>"+i+"</option>";
//            }

            //$('#'+objOption.yearOjb.yearId).html(newOptions);


            for (i = stringYearStart; i <= stringYearEnd; i++) {
                newOptions += "<option value='" + i + "'>" + i + "</option>";
            }

            //写入HTML
            $('#' + objOption.yearOjb.yearId).html(newOptions);
        },
        monthHtml: function (objOption) {
            if ($('#' + objOption.monthOjb.monthId).length == 0) {
                alert('当前文档没有定义月份属性' + objOption.monthOjb.monthId + '值');
                return;
            }

            var newOptions = "";
            for (i = 1; i <= 12; i++) {
                var newi = i < 10 ? '0' + i : i;
                newOptions += "<option value='" + newi + "'>" + newi + "</option>";
            }

            if (objOption.dayOjb != undefined) {
                //绑定onchange事件
                $('#' + objOption.monthOjb.monthId).bind('change', function () {
                    objOption.operaterDom.dayHtml(objOption, 1);
                });
            }
            //写入HTML
            $('#' + objOption.monthOjb.monthId).html(newOptions);

        },
        dayHtml: function (objOption, type) { //type 0为初始数据 1为选择后数据
            if ($('#' + objOption.dayOjb.dayId).length == 0) {
                alert('当前文档没有定义时间天属性' + objOption.dayOjb.dayId + '值');
                return;
            }

            var dayNum = "";
            if (type == 1) {

                //判断闰年
                var selectedYear = $('#' + objOption.yearOjb.yearId).val();
                var selectedMonth = $('#' + objOption.monthOjb.monthId).val();


                var inMonth = selectedMonth < 10 ? selectedMonth.substr(-1, 1) - 1 : selectedMonth - 1;

                var isLeapYear = (selectedYear % 4 == 0 && !(selectedYear % 100 == 0)) || selectedYear % 400 == 0 ? 1 : 0;
                /*4, 6, 9, 11 月为 30 天，注意上面的 inMonth = inMonth - 1*/
                if (inMonth == 3 || inMonth == 5 || inMonth == 8 || inMonth == 10) {
                    dayNum = 30;
                } else if (inMonth == 1) {/*2 月为 28 或者 29 天，视是否为闰年而定*/
                    dayNum = 28 + isLeapYear;
                } else {/*其它月则为 31 天*/
                    dayNum = 31;
                }
            } else {
                dayNum = 31;
            }
            var newOptions = "";
            for (i = 1; i <= dayNum; i++) {
                var newi = i < 10 ? '0' + i : i;
                newOptions += "<option value='" + newi + "'>" + newi + "</option>";
            }

            //写入HTML
            $('#' + objOption.dayOjb.dayId).html(newOptions);
            return newOptions;

        },


        createListHtml: function (objOption) {
            objOption.operaterDom.yearHtml(objOption);
            //显示默认值
            if (objOption.yearOjb.defaultYear != undefined) {
                $('#' + objOption.yearOjb.yearId).val(objOption.yearOjb.defaultYear);
            }


            objOption.operaterDom.monthHtml(objOption);
            if (objOption.monthOjb.defaultMonth != undefined) {
                $('#' + objOption.monthOjb.monthId).val(objOption.monthOjb.defaultMonth);
            }

            if (objOption.dayOjb != undefined) {
                objOption.operaterDom.dayHtml(objOption, 0);
                if (objOption.dayOjb.defaultDay != undefined) {
                    $('#' + objOption.dayOjb.dayId).val(objOption.dayOjb.defaultDay);
                }
            }

        }

    }
    $(document).ready(function () {
        var objOption = {
            operaterDom: bbc.getDateList, //操作函数名
            yearOjb: {
                yearId: 'BBC_yearId',  //操作年份ID
                yearStart: 2010,       //年份开始时间
                yearEnd: 2015,          //年份结束时间
                defaultYear: 2013       //默认当前显示年份

            },
            monthOjb: {
                monthId: 'BBC_monthId',  //操作月份ID
                defaultMonth: '12'          //默认月份
            },
            dayOjb: {
                dayId: 'BBC_dayId',          //天ID
                defaultDay: '05'             //默认天
            }
        }
        bbc.getDateList.createListHtml(objOption);
    });


</script>

<div style="border:2px dashed #020; padding:20px;width:300px;border-color:grey;float: left;margin-bottom: 10px"
     xmlns="http://www.w3.org/1999/html">
  <h3>我爱斗地主推送管理</h3><br>
</div>
<div style="border:2px dashed  #030; padding:20px;width:300px;border-color:grey;float: left;margin-left:300px;margin-bottom: 100px">
  <img src="../new.png">状态：
  <h3><font color="red"></font></h3>
</div>
<br>
<%= form_tag("", method: "post") do %>
    <table class="index_table index">
      <tr class="even">
        <td>推送内容:&nbsp<textarea name="content"></textarea></td>

      </tr>
      <tr class="even">
        <td>推送时间:&nbsp
          <select name="helperYear" id="BBC_yearId"></select>年
          <select name="helperMonth" id="BBC_monthId"> </select>月
          <select name="helperDay" id="BBC_dayId"> </select>日
          <select name="helpHour">
            <% for i in 0..23 do %>
                <% if i<10
                     i="0#{i}"
                   end
                %>
                <option value="<%= i %>"><%= i %></option>
            <% end %>
          </select>时
          <select name="helpMintue">
            <% for i in 0..59 do %>
                <% if i<10
                     i="0#{i}"
                   end
                %>
                <option value="<%= i %>"><%= i %></option>
            <% end %>
          </select>分
        </td>
      </tr>
      <tr class="even">
        <td>优先级:&nbsp&nbsp&nbsp<select name="level">
          <option value=1>优先</option>
          <option value=2>普通</option>
          <option value=3>撤销</option>
        </select> &nbsp 显示位置:&nbsp&nbsp<select name="position" ><option value="1">通知栏</option><option value="2">大厅跑马灯</option></select></td>
      </tr>


      <tr class="even">
        <td>
          <button name="create">新建</button>

        </td>
      </tr>
    </table>
<% end %>